From 54ac4ab2b53ce9fcb66b8250dee91c070e4167ed Mon Sep 17 00:00:00 2001
From: "djm@openbsd.org" <djm@openbsd.org>
Date: Thu, 9 Mar 2023 06:58:26 +0000
Subject: [PATCH] upstream: include destination constraints for smartcard keys
 too.

Spotted by Luci Stanescu; ok deraadt@ markus@

OpenBSD-Commit-ID: add879fac6903a1cb1d1e42c4309e5359c3d870f
---
 authfd.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

--- a/authfd.c
+++ b/authfd.c
@@ -665,7 +665,7 @@ ssh_update_card(int sock, int add, const
     struct dest_constraint **dest_constraints, size_t ndest_constraints)
 {
 	struct sshbuf *msg;
-	int r, constrained = (life || confirm);
+	int r, constrained = (life || confirm || dest_constraints);
 	u_char type;
 
 	if (add) {
